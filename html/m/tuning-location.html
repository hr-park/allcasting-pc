<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
	<title>All CASTING</title>
	<link rel="stylesheet" href="../static/css/NotoSansKR.css">
	<link rel="stylesheet" href="../static/css/style.css">
	<link rel="stylesheet" href="../static/css/swiper-bundle.min.css" />
    <link rel="stylesheet" href="../static/css/flatpickr.min.css">
	<script src="../static/js/swiper-bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
	<script src="https://npmcdn.com/flatpickr/dist/l10n/ko.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script src="../static/js/common.js"></script>
</head>
<body>
	<div class="wrap">
		<header class="header_type1">
			<div>
				<a href="javascript://" class="btn_prev">이전</a>
				<a href="javascript://" class="btn_home">HOME</a>
			</div>
			<p class="page_name">새 프로필 만들기</p>
			<a href="javascript://" class="btn_next">다음</a>
		</header>
		<nav class="page_nav">
			<ul>
				<li class="active"><a href="#">기본 정보</a></li>
				<li><a href="#">사진</a></li>
				<li><a href="#">경력</a></li>
				<li><a href="#">영상</a></li>
			</ul>
		</nav>
		<div class="content">
			<a href="javascript:openPop('pop_tuning_location')" style="display:block;width:70%;margin:30px auto;border:1px solid #222;height:36px;line-height:36px;text-align:center;">오디션 장소 입력 팝업</a>
		</div>

		<div id="pop_tuning_location" class="dim_layer full">
			<div class="dim"></div>
			<div class="pop_wrap">
				<div class="pop_handle" onclick="closePop('pop_tuning_location')"></div>
				<div class="pop_cont">
					<div class="sub_tit">오디션 장소 입력</div>
					<div class="addr_form">
						<div class="addr_search" id="addrSearch">
							<!-- tuning-location-1 -->
							<div class="search_box">
								<div class="inp_field">
									<input type="text" name="searchBar" id="searchBar" class="search_bar" placeholder="장소 이름이나 주소를 입력하세요."/>
									<button type="button" class="btn_reset" onclick="clearAddress(this)">X</button>
								</div>
							</div>

							<!-- tuning-location-2 -->
							<div class="addr_list" id="addrList">
								<!-- <a href="#" onclick="showAddrDetail(this)">
									<span class="label">에프티엔티</span>
									<div class="txt">서울 서초구 서초대로 40길 96</div>
								</a> -->
							</div>
						</div>

						<!-- tuning-location-3 -->
						<div class="addr_detail" id="addrDetail" style="display:none;">
							<div class="inp_field">
								<input type="text" name="locationName" id="locationName" class="location_name" placeholder="장소 이름이나 주소를 입력하세요." oninput="handleAddrDetail(this)" />
							</div>
							<div class="inp_field">
								<input type="text" name="locationAddress1" id="locationAddress1" class="location_address1" placeholder="주소를 입력해 주세요." oninput="handleAddrDetail(this)" />
							</div>
							<div class="inp_field">
								<input type="text" name="locationAddress2" id="locationAddress2" class="location_address2" placeholder="세부 주소를 입력해 주세요." oninput="handleAddrDetail(this)" />
							</div>

							<div class="fix_bottom">
								<a href="javascript:submitTuningLocation()" class="btn_line">장소입력완료</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div><!-- //wrap -->
	<script>
		// 퍼블 확인용 json
		const testJson = [
			{
				"location_name": "에프티엔티",
				"location_addr": "서울 서초구 서초대로 40길 96",
			},
			{
				"location_name": "한샘리하우스 지움대리점",
				"location_addr": "서울 서초구 서초대로 40길 96",
			},
			{
				"location_name": "서울 서초구 41길 54",
				"location_addr": "서초동 157-4",
			}
		];

		// 퍼블 확인용 주소 렌더링
		function renderLocation(locations, container){
            let htmlContent = '';

            for (let i = 0; i < locations.length; i++) {
                htmlContent += `
					<a href="#" onclick="showAddrDetail(this)">
						<span class="label">${locations[i].location_name}</span>
						<div class="txt">${locations[i].location_addr}</div>
					</a>
                `;
            }
            container.innerHTML = htmlContent;
		}

		const addrSearch = document.querySelector('#addrSearch');	// 장소 검색 box
		const addrDetail = document.querySelector('#addrDetail');	// 장소 입력 box
		const searchBar = document.querySelector('#searchBar'); // 검색 input
		const addrList = document.querySelector('#addrList'); // 검색 List
		const locationName = document.querySelector('#locationName');	// 장소 이름
		const locationAddress1 = document.querySelector('#locationAddress1');	// 장소 메인 주소
		const locationAddress2 = document.querySelector('#locationAddress2');	// 장소 세부 주소

		function clearAddress(target){
			const addrList =  document.querySelector('#addrList');
			target.previousElementSibling.value = '';
			target.previousElementSibling.focus();
			target.style.display = 'none';

			addrList.innerHTML = '';
		}

		// handler 검색바
		searchBar.addEventListener('input', function(){
			const btnReset = this.nextElementSibling;
			// console.log(btnReset);

			if(this.value === ''){
				btnReset.style.display = 'none';
				addrList.innerHTML = '';

			}else{
				btnReset.style.display = 'block';
				renderLocation(testJson, addrList);
			}
		});

		function showAddrDetail(target){
			let locationNameValue = target.querySelector('.label').textContent;
			let locationAddressValue = target.querySelector('.txt').textContent;

			locationName.value = locationNameValue;
			locationAddress1.value = locationAddressValue;
			locationName.classList.add('active');
			locationAddress1.classList.add('active');

			addrSearch.style.display = 'none';
			addrDetail.style.display = 'block';
		}

		function handleAddrDetail(target){
			if(target.value === ''){
				target.classList.remove('active');
			}
		}

		function submitTuningLocation(){
			closePop('pop_tuning_location');

			// 팝업 초기화
			addrSearch.style.display = 'block';
			addrDetail.style.display = 'none';
			addrList.innerHTML = '';
			locationName.value = '';
			locationAddress1.value = '';
			locationAddress2.value = '';

			searchBar.value = '';
			searchBar.nextElementSibling.style.display = 'none';
		}
	</script>
</body>
</html>
